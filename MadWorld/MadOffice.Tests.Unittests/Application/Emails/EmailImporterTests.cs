using AutoFixture.Xunit2;
using FluentAssertions;
using MadOffice.Application.Emails;
using MadOffice.Domain.Emails.Interfaces;
using MadOffice.Domain.Emails.Models;
using Moq;

namespace MadOffice.Tests.Unittests.Application.Emails;

public class EmailImporterTests
{
        [Theory]
    [AutoDomainData]
    public void Import_GivenValidEmailExcelFile_ThreePersons(
        [Frozen] Mock<IEmailReader> emailReader,
        EmailImporter emailImporter
        )
    {
        // Arrange
        // There are two persons in the base64 Excel. 
        const string excelBase64 = "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";
        var excelStream = new MemoryStream(Convert.FromBase64String(excelBase64));

        emailReader.Setup(er => er.Save(It.IsAny<List<Person>>()))
            .Returns(true);

        var emailType = EmailType.GeneralInfo;
        
        // Act
        var succeed = emailImporter.Import(excelStream, emailType);

        // Assert
        succeed.Should().BeTrue();
        emailReader.Verify(
            er => er.Save(
                It.Is<List<Person>>(
                    p => p.Count == 2 &&
                         p[0].Id == 1 &&
                         p[0].FirstName == "John" &&
                         p[0].LastName == "Doe" &&
                         p[0].Email == "test@test.nl" &&
                         p[0].EmailType == EmailType.GeneralInfo
                )),
            Times.Once);
    }
}